# webOS TV API Assistant 확장 프로그램 개선 PRD

## 📋 개요

### 제품명
webOS TV API Assistant VS Code Extension v2.0

### 목적
현재 확장 프로그램의 자동완성, 스니펫, hover 기능에서 발견된 문제점들을 해결하여 webOS TV 개발자의 생산성을 향상시킵니다.

### 범위
- VS Code 확장 프로그램 핵심 기능 개선
- MCP 서버 연결 안정성 향상
- API 데이터 구조 표준화
- 사용자 경험 최적화

## 🔍 현재 문제점 분석

### 1. 자동완성 기능 문제점 (Critical)
**문제**: Service URI 매핑 불일치
- **현상**: `luna://com.webos.audio` vs `luna://com.webos.service.audio` 불일치
- **영향**: 자동완성이 작동하지 않거나 잘못된 URI 제안
- **우선순위**: 🔥 Critical

**문제**: Smart Completion 버그
- **현상**: `getPointerStatemethodName` 같은 이상한 문자열 생성
- **영향**: 코드 품질 저하, 개발자 혼란
- **우선순위**: 🔥 Critical

**문제**: MCP 서버 fallback 부족
- **현상**: MCP 서버 연결 실패 시 기본 자동완성도 제공되지 않음
- **영향**: 확장 프로그램 사용 불가
- **우선순위**: 🔥 Critical

### 2. Hover 기능 문제점 (High)
**문제**: 비동기 처리 불완전
- **현상**: `createMethodHoverAsync`가 있지만 동기 메서드 호출
- **영향**: MCP 서버 응답 지연 시 UI 블록
- **우선순위**: ⚡ High

**문제**: Fallback 체인 불완전
- **현상**: MCP → File → Hardcoded 순서 중 중간 실패 시 정보 없음
- **영향**: 개발자에게 도움 정보 제공되지 않음
- **우선순위**: ⚡ High

### 3. MCP 서버 연결 문제점 (High)
**문제**: 서버 경로 탐지 불안정
- **현상**: 배포 환경에서 MCP 서버 찾지 못함
- **영향**: 확장 기능 전체 실패
- **우선순위**: ⚡ High

**문제**: 연결 상태 관리 부족
- **현상**: 연결 끊어져도 재연결 시도 없음
- **영향**: 사용자가 VS Code 재시작 필요
- **우선순위**: ⚡ High

### 4. API 데이터 구조 문제점 (Medium)
**문제**: Service URI 불일치
- **현상**: `api-index.json`과 개별 API 파일의 URI 다름
- **영향**: 데이터 일관성 부족
- **우선순위**: 💎 Medium

**문제**: 스키마 일관성 부족
- **현상**: `examples` vs `example` 필드명 혼재
- **영향**: 파싱 오류 가능성
- **우선순위**: 💎 Medium

### 5. 성능 문제점 (Low)
**문제**: 불필요한 MCP 호출
- **현상**: 자동완성마다 MCP 서버 호출
- **영향**: 응답 지연, 서버 부하
- **우선순위**: 🔵 Low

## 🎯 개선 요구사항

### Phase 1: Critical Issues (즉시 수정)

#### 1.1 Service URI 정규화
**목표**: 일관된 Service URI 사용
**요구사항**:
- [ ] URI 매핑 테이블 생성
- [ ] 자동 정규화 함수 구현
- [ ] 호환성을 위한 alias 지원

**성공 기준**:
- 모든 Luna Service URI가 일관되게 매핑됨
- 기존 코드와 호환성 유지

#### 1.2 Smart Completion 로직 개선
**목표**: 깔끔한 코드 자동완성
**요구사항**:
- [ ] 문자열 교체 로직 단순화
- [ ] 정규표현식 기반 매칭 개선
- [ ] 엣지 케이스 처리

**성공 기준**:
- 이상한 문자열 생성 없음
- 자동완성 품질 95% 이상

#### 1.3 Fallback 체인 강화
**목표**: MCP 서버 없이도 기본 기능 제공
**요구사항**:
- [ ] 로컬 API 데이터 fallback
- [ ] 최소 기능 보장
- [ ] 사용자 알림 개선

**성공 기준**:
- MCP 서버 연결 실패해도 기본 자동완성 작동
- 사용자에게 명확한 상태 표시

### Phase 2: High Priority Issues (단기 개선)

#### 2.1 비동기 Hover 처리
**목표**: 응답성 좋은 hover 정보 제공
**요구사항**:
- [ ] 완전한 비동기 처리
- [ ] 타임아웃 설정
- [ ] 로딩 상태 표시

**성공 기준**:
- Hover 응답 시간 2초 이내
- UI 블록 없음

#### 2.2 MCP 연결 관리 개선
**목표**: 안정적인 MCP 서버 연결
**요구사항**:
- [ ] 자동 재연결 기능
- [ ] 연결 상태 모니터링
- [ ] 에러 복구 메커니즘

**성공 기준**:
- 연결 끊어져도 30초 이내 자동 복구
- 사용자 개입 없이 복구

### Phase 3: Medium Priority Issues (중기 개선)

#### 3.1 API 데이터 표준화
**목표**: 일관된 데이터 구조
**요구사항**:
- [ ] 스키마 정의서 작성
- [ ] 데이터 검증 도구
- [ ] 마이그레이션 스크립트

**성공 기준**:
- 모든 API 파일이 동일한 스키마 준수
- 자동 검증 통과

### Phase 4: Low Priority Issues (장기 개선)

#### 4.1 성능 최적화
**목표**: 빠른 응답과 효율적인 리소스 사용
**요구사항**:
- [ ] 캐싱 시스템
- [ ] 지연 로딩
- [ ] 메모리 관리

**성공 기준**:
- 자동완성 응답 시간 500ms 이내
- 메모리 사용량 50% 절약

## 📅 개발 일정

### Week 1-2: Phase 1 (Critical Issues)
- Service URI 정규화
- Smart Completion 개선
- Fallback 체인 구현

### Week 3-4: Phase 2 (High Priority)
- 비동기 Hover 처리
- MCP 연결 관리

### Week 5-6: Phase 3 (Medium Priority)
- API 데이터 표준화
- 테스트 및 검증

### Week 7-8: Phase 4 & 통합 테스트
- 성능 최적화
- 전체 기능 테스트

## 🧪 테스트 계획

### 단위 테스트
- [ ] URI 정규화 함수
- [ ] Smart completion 로직
- [ ] Fallback 체인

### 통합 테스트
- [ ] MCP 서버 연결/재연결
- [ ] 자동완성 전체 플로우
- [ ] Hover 정보 표시

### 사용자 테스트
- [ ] 실제 webOS TV 프로젝트에서 테스트
- [ ] 개발자 피드백 수집
- [ ] 성능 측정

## 📊 성공 지표

### 기능 지표
- 자동완성 정확도: 95% 이상
- Hover 정보 표시율: 98% 이상
- MCP 서버 연결 성공률: 99% 이상

### 성능 지표
- 자동완성 응답 시간: 500ms 이내
- Hover 응답 시간: 2초 이내
- 확장 프로그램 시작 시간: 5초 이내

### 사용자 만족도
- 버그 리포트: 50% 감소
- 사용자 평점: 4.5/5.0 이상
- 설치 수: 30% 증가

## 🚀 출시 기준

### Release Criteria
- [ ] 모든 Critical 이슈 해결
- [ ] 90% 이상 테스트 커버리지
- [ ] 성능 지표 달성
- [ ] 사용자 테스트 완료

### 롤백 계획
- 현재 버전 백업 유지
- 빠른 롤백 시나리오 준비
- 사용자 알림 프로세스

---

**문서 작성자**: AI Assistant  
**작성일**: 2025-01-18  
**버전**: v1.0  
**승인 대기 중**
